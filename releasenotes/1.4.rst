#format dojo_rst

Dojo 1.4 Release Notes
=======================

.. contents::
   :depth: 3

====
Dojo
====

`IO Pipeline Topics <dojo/ioPipelineTopics>`_
----------------------------------------------
Now there are topics that are published for the pipeline used to handle all IO operations. dojo.xhr, dojo.io.script and dojo.io.iframe all use the IO pipeline, so they can all publish the pipeline topics. By default, the topics are turned off. To enable them, set **djConfig.ioPublish = true**. After they are globally enabled, you can disable them for specific IO requests by setting **ioPublish: false** in the arg object you pass to dojo.xhr*, dojo.io.script.get() or dojo.io.iframe.send(). See `IO Pipeline Topics <dojo/ioPipelineTopics>`_ for more information.

`dojo.addOnLoad <dojo/addOnLoad>`_
----------------------------------

There was a dojo.require/onload fix done for Firefox browsers (see `Ticket #8976 <http://bugs.dojotoolkit.org/ticket/8976>`_).

`dojo.ready <dojo/ready>`_
----------------------------------

It is just an alias for `dojo.addOnLoad <dojo/addOnLoad>`_.

`dojo.fieldToObject <dojo/fieldToObject>`_
-------------------------------------------
A new method in Dojo Base (part of dojo.js) that is related to dojo.formToObject(), except instead of converting a whole form to an object, it just converts one form field. Pass it a DOM Node for the field, or the ID of the form field as a string. dojo.fieldToObject returns the value encoded in a form field as as a string or an array of strings. Disabled form elements and unchecked radio and checkboxes are skipped. Multi-select elements are returned as an array of string values. See `dojo.fieldToObject <dojo/fieldToObject>`_ for more information.

`dojo.position <dojo/position>`_
-------------------------------------------
A new method in Dojo Base (part of dojo.js) that returns the beginning x/y of a DOM node's border-box as well as it's width and height.  An optional boolean parameter can be specified to change the default coordinate origin point from the viewport to the document root.

`dojo.coords <dojo/coords>`_
-------------------------------------------
This method in Dojo Base has been deprecated in Dojo 1.4.  The returned object is a mixin of `dojo.position <dojo/position>`_ and `dojo.marginBox <dojo/marginBox>`_.  Because the x/y position is based on the border-box and the (w)idth/(h)eight attributes represent the margin-box, there was considerable confusion on correctly using the returned object.  The new method `dojo.position <dojo/position>`_ performs much faster.  Users needing the l/t/w/h attributes from this method can continue to use `dojo.marginBox <dojo/marginBox>`_.

`dojo.declare <dojo/declare>`_
------------------------------

A drop-in replacement is committed, which is generally faster, and introduces enhancements to the familiar functionality. The announcement link: http://groups.google.com/group/dojo-interest/msg/4a22b20587e91d27

TODO: document or link to blog post (Eugene)

`dojo.cache <dojo/cache>`_
--------------------------
A new method has been added for caching data from files.   In particular it's used in templated widgets in conjunction with templateString, rather than templatePath.

Dojo Base FX
------------

* Considerable performance increase and new API's
* made dojo._Animation public: dojo.Animation
* onEnd, beforeBegin functions are passed the node reference used in the Animation
* start: and end: properties, when using a function, are passed the node reference for the animtion
* each property can now be a function, returning either a value, or and object to pass as the value

`dojo.hash <dojo/hash>`_
--------------------------

A new method for monitoring, getting and setting the hash value.  dojo.hash provides hashchange notification using a new published topic "/dojo/hashchange", enabling cross-browser back/forward support and bookmarkability in AJAX applications. The native HTML 5 onhashchange event is used behind the scenes in browsers that support it.

Dojo i18n
---------

The cultural tables in dojo/cldr have been updated to version 1.7.1 of the Unicode CLDR http://unicode.org/cldr

======
Dijit
======

top level widgets
-----------------
Tree
~~~~
* dijit._tree.dndSource moved to dijit.tree.dndSource (since it's supposed to be used publicly)
* Lots of cleanup and bug fixes around DnD related code
* Multi-character search.  Typing "al" will jump directly to first node starting with "al".
* new Path and selectedItem attributes to get/set the current tree item (`#9339 <http://bugs.dojotoolkit.org/ticket/9339>`_)
* Multi-parented items support.   Tree can support items with multiple parents, as long as this doesn't cause a loop.  (`#9361 <http://bugs.dojotoolkit.org/ticket/9361>`_)
* Deferred child load option on TreeStoreModel.  Option added to deferring calling loadItem() on a data store item until it's children need to be read.  Performance boost for JsonRestStore.  (`#9575 <http://bugs.dojotoolkit.org/ticket/9575>`_)


Editor
~~~~~~
The RTE has had numerous bug fixes applied to it as well as some code cleanup to make it more extensible and better behaving on browsers such as Opera.  It also had several new plugin modules added to dijit, as well as several new ones added to dojox.  For information on the dojox modules, see the dojox section of these release notes.

* `FullScreen <dijit/_editor/plugins/FullScreen>`_:  A plugin that adds the capability to the editor to take over the complete viewport containing the page running the editor.

* `ViewSource <dijit/_editor/plugins/ViewSource>`_:  A plugin that lets you toggle the editor view between HTML source and RTE modes.

* `Print <dijit/_editor/plugins/Print>`_:  A plugin that lets you print the contents of the editor frame.

* `NewPage <dijit/_editor/plugins/NewPage>`_:  A plugin that lets you clear the content of the editor and set a new default content with a button click.

In addition to the new plugins, the editor icons have all been updated!  They are much cleaner and professional.

Dialog
~~~~~~
* Multiple dialogs can now be shown (with one dialog launching over another).
* Dialog supports aria-describedby to make it more accessible to screen readers.

Menu
~~~~
Sliding the mouse diagonally from a vertical menu to a second vertical menu will no longer close the second menu if the mouse temporarily moves off of both menus.   (This happens when the MenuItem in the second menu is below the bottom of the first Menu.) ( (`#6773 <http://bugs.dojotoolkit.org/ticket/6773>`_)

TitlePane
~~~~~~~~~
toggleable attribute to control whether or not user can close the TitlePane.  Useful for non-closable TitlePane's in a app that match the styling of the other TitlePanes (and other dijit components).

Tooltip
~~~~~~~
addTarget()/removeTarget() methods to dynamically attach/detach the tooltip from various nodes.

dijit.layout
------------
TabContainer / AccordionContainer
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
* scrolling tab labels now supported (like on Firefox etc.) so that labels don't spill over to two rows when there isn't enough space
* tab labels / pane titles can be changed via pane.attr('title', ...)
* icons added, controlled via iconClass parameter (like for Buttons and MenuItems).   To display only icons set showTitle=false.

ContentPane
~~~~~~~~~~~
Fixes related to resizing and href loading, including avoiding premature href loading for ContentPanes in nested TabContainers.  ContentPane now acts as a full layout widget, calling resize() on it's child widgets when (not before) it is made visible, avoiding problems with children being initialized while hidden.


dijit.form
----------
Button
~~~~~~
Although not related to the Dojo 1.4 release per-se, note that to support IE8 all dijit.form.Button's declared in markup must have type=button (unless they are intended as submit buttons).   This is to work around an IE8 problem where the parser can't distinguish between an explicit type=submit and an implicit one.   (The default type for <button> tags is submit, according to the latest HTML spec.)

Select
~~~~~~
dojox.form.DropDownSelect has been moved to dijit.Select as a styled HTML <select> replacement.

Calendar
~~~~~~~~~~~~~~~~~~~~
Calendar standalone widget now supports accessibility with ARIA and keyboard.  The widget was promoted to a public object, renamed from dijit._Calendar to dijit.Calendar.  Users can select a date in the calendar using arrow keys, and page-down/up for month navigation.  There is also a dropdown at the month label to change the month.  DateTextBox still relies on the input control for a11y and does not transfer focus to the calendar popup.

TextBox
~~~~~~~
selectOnClick attribute added to `dijit.form.TextBox <dijit/form/TextBox>`_ and all descendant form widgets, selecting all the text in the field just by clicking.   This makes it easier for users to change the value: just click and type.

DropDownButton, ComboButton
~~~~~~~~~~~~~~~~~~~~~~~~~~~
dropDownPosition parameter controls where the drop down appears, as usual searching a list of positions until somewhere is found where the drop down fits.   Example:  dropDownPosition="top,bottom"

onChange event handling
~~~~~~~~~~~~~~~~~~~~~~~
Most dijit.form widgets fire the onChange event after a value change has been detected.  With some widgets, this event fired synchronously before the attr('value',val) returned, while on other widgets, the event was asynchronous.  In order to return control to the browser's UI thread sooner, and also to collapse onChange events that fire faster tha the user handler can execute, the events will always fire asynchronously now, and consecutive, unprocessed onChange events will be collapsed into single events.  User code that assumed onChange would always fire synchronously after a value change will have to be modified.

NumberSpinner
~~~~~~~~~~~~~
The `NumberSpinner <dijit/form/NumberSpinner>`_ widget has changed the **required** attribute default value from true to false to more consistently allow for unspecified values within a FORM.

Dijit infrastructure changes
----------------------------
_Templated
~~~~~~~~~~
* widgetsInTemplate widget lifecycle: lots of bug fixes around the lifecycle for widgets in templates.  startup() is now called on widgets in templates when startup() is called on the main widget.   Templated Layout widgets with widgets in their templates should call resize() on those widgets manually.
* templatePath has been deprecated in favor of templateString used with dojo.cache(), see above.


dijit.WidgetSet enhancements
~~~~~~~~~~~~~~~~~~~~~~~~~~~~
dijit.WidgetSet/dijit.registry now has a .length property, and new array-like functions: toArray, some, every, and map. forEach now returns instance for chaining. forEach, some, every, filter and map now accept a 'thisObj' as second or third param (after callback)

Browser support
---------------
* Firefox 2 support dropped.  Firefox V3 and V3.5 supported.
* Latest Safari (Safari v4) and latest Chrome (Chrome v3) supported, but not previous versions.
* IE6, IE7, IE8 all supported
* Keyboard now supported in all browsers (previously it didn't work in safari and on chrome)

======
Dojox
======

dojox.image
-----------

* Significant fixes and improvements in dojox.image.Lightbox. see: `[17205] <http://bugs.dojotoolkit.org/changeset/17205>`_

dojox.fx
--------

* API change to dojox.fx.style functions. dojox.fx.addClass/toggleClass/removeClass now match dojo.addClass/toggleClass/removeClass API's. Documentation added, still experimental.
* Added dojox.fx.ext-dojo.NodeList-style module, mapping dojox.fx.style functions into dojo.NodeList

dojox.layout
------------

* dojox.layout.ContentPane.attr('href', ...) now returns a dojo.Deferred rather than a dojox.layout.ContentPane.DeferredHandle custom class.   The dojo.Deferred triggers when the load completes (or errors out).

dojox.grid
----------

* dojox.grid.TreeGrid - support for collapsable rows and model-based (dijit.tree.ForestStoreModel) structure.
* compat grid (dojox.grid.Grid) is now bundled in the dojox/grid directory as a tarball archive for those who would like to continue using the deprecated (1.1) Grid.  dojox.grid.DataGrid is the replacement.

dojox.grid.EnhancedGrid
-----------------------
The new Enhanced DataGrid extends the base grid in numerous useful ways.

* Nested Sort:  The user can now concurrently sort on any number of columns.
* Multiple Column/Row Selection: The user can now select multiple columns or rows through swipe-select or extended selection techniques.
* Drag-drop Multiple Columns and Rows: The user can now move multiple columns or rows in the same action.
* Indirect Selection: Rather than having to manually include radio buttons and check boxes for single and multiple selection models, the Enhanced DataGrid will do it automatically in response to the inclusion of simple attribute-value pairs, e.g., indirectSelection=true, on the grid's div tag. 
* Declarative Pop-up Menus: Rather than having to create and assign pop-up menus through scripts, the enhanced DataGrid allows you to specify these menus with straightforward markup.

dojox.form
----------

* dojox.form._HasDropDown, dojox.form._FormSelectWidget, dojox.form.DropDownSelect - Migrated to dijit (dijit._HasDropDown, dijit.form._FormSelectWidget, dijit.form.Select)

dojo.form.FileUploader
----------------------

* The improved FileUploader actually landed in a "dot release", 1.3.1, but 1.4 adds some bug fixes. The new FileUploader adds many features, and the display is now quite robust. The Flash uploader is now an actual Flash button with an emulated HTML style, so that it can be used in cases where it was broken before, like in scrolling boxes. The HTML uploader too has been improved so that it is not floating on the page, allowing for more complex display cases and less UI breakage.

dojox.drawing
-------------

A new drawing tool has landed in DojoX. Similar to Sketch, but with an extensible architecture that allows for plugins.

dojox.editor.plugins
--------------------
Several new plugins for the dijit.Editor RTE have been provided as dojox modules.  They are all generally well tested and work good across browsers.

* `PrettyPrint <dojox/editor/plugins/PrettyPrint>`_:  A plugin that formats the output from dijit.Editor more cleanly than the browsers defaults.

* `PageBreak <dojox/editor/plugins/PageBreak>`_:  A plugin that lets you insert CSS style page breaks so when printed, the document page breaks at the indicated spot.

* `ShowBlockNodes <dojox/editor/plugins/ShowBlockNodes>`_:  A plugin that lets you see in the editor what the block structure is that makes up the RTE document.

* `Preview <dojox/editor/plugins/Preview>`_:  A plugin that lets you preview the editor content in a separate window with different CSS styles and stylesheets applied than what are used in the editor.

* `Save <dojox/editor/plugins/Save>`_:  A plugin that simplifes adding a save toolbar action for posting editor content back to a specified url.

* `ToolbarLineBreak <dojox/editor/plugins/ToolbarLineBreak>`_:  A simple plugin that provides a way to break the editor toolbar into multiple lines.

=========
Bug fixes
=========
The `full list of bug fixes <http://bugs.dojotoolkit.org/query?status=closed&group=component&order=priority&milestone=1.4&resolution=fixed&col=id&col=summary&col=type&col=priority>`_ is located in the bug database.
